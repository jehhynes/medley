<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.1</storyId>
    <title>Project Setup and Development Environment</title>
    <status>Draft</status>
    <generatedAt>2025-10-17</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/story-1.1.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>a developer</asA>
    <iWant>to establish the core ASP.NET Core project structure with proper configuration and development environment</iWant>
    <soThat>I have a solid foundation for building the AI-powered documentation platform</soThat>
    <tasks>
      - Task 1: Create ASP.NET Core MVC Project Structure (AC: #1)
      - Task 2: Configure PostgreSQL Database (AC: #2, #6)
      - Task 3: Set up Entity Framework Core (AC: #3)
      - Task 4: Implement Health Check Endpoint (AC: #4)
      - Task 5: Configure Logging with Serilog (AC: #5)
      - Task 6: Verify Development Environment (AC: #7)
    </tasks>
  </story>

  <acceptanceCriteria>
    1. ASP.NET Core MVC project created with proper folder structure and namespacing
    2. Local PostgreSQL database configured with connection strings for development/production
    3. Entity Framework Core configured with initial migration
    4. Basic health check endpoint implemented and accessible
    5. Logging framework (Serilog) configured with appropriate log levels
    6. Development environment setup documented for local PostgreSQL installation with pgvector extension
    7. Hot reload and debugging capabilities verified working
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc path="docs/solution-architecture.md" title="Solution Architecture Document" section="Application Architecture" snippet="Clean Architecture monolith using ASP.NET Core MVC with server-side rendering and abstracted external dependencies. The system processes meeting transcripts, extracts insights using AI services, clusters related content, and generates comprehensive documentation through a transparent human-AI review process." />
      <doc path="docs/tech-spec-epic-1.md" title="Tech Spec: Epic 1 - Foundation & Core Infrastructure" section="Technology Stack" snippet="ASP.NET Core MVC 9.0 with Built-in DI for Clean Architecture support, PostgreSQL 16.0+ with pgvector extension for ACID compliance, Entity Framework Core 9.0+ with Code-first migrations and LINQ support." />
      <doc path="docs/epics.md" title="Medley - Epic Breakdown" section="Epic 1: Foundation & Core Infrastructure" snippet="Establish the foundational infrastructure for the AI-Powered Product Intelligence Platform, including project setup, authentication system, vector database, core data models, background processing, and basic UI framework." />
      <doc path="docs/PRD.md" title="Medley Product Requirements Document" section="Goals and Background Context" snippet="The AI-Powered Product Intelligence Platform addresses a fundamental paradox in software development: developers understand the critical value of documentation for end users and AI-powered help systems, but actively avoid writing it due to time constraints." />
    </docs>
    <code>
      <!-- No existing code artifacts - this is the foundational story establishing the project structure -->
    </code>
    <dependencies>
      <dotnet>
        <package name="Microsoft.AspNetCore.App" version="9.0" />
        <package name="Microsoft.EntityFrameworkCore" version="9.0" />
        <package name="Microsoft.EntityFrameworkCore.Design" version="9.0" />
        <package name="Npgsql.EntityFrameworkCore.PostgreSQL" version="9.0" />
        <package name="Serilog.AspNetCore" version="9.0" />
        <package name="Microsoft.Extensions.Diagnostics.HealthChecks" version="9.0" />
        <package name="Microsoft.Extensions.Diagnostics.HealthChecks.EntityFrameworkCore" version="9.0" />
      </dotnet>
    </dependencies>
  </artifacts>

  <constraints>
    - Follow Clean Architecture pattern with clear layer separation and dependency inversion
    - Use interface abstractions for external dependencies (Database: IDbContextFactory&lt;T&gt;, Repository: IRepository&lt;T&gt;)
    - PostgreSQL 16.0+ required for pgvector extension support for future AI vector operations
    - ASP.NET Core MVC 9.0 with server-side rendering approach
    - Entity Framework Core 9.0+ with Code-First migrations for database schema management
    - Solution file and tests located under src/ directory for better organization
    - All dependencies point inward to Domain layer
    - Direct entity usage (no DTOs between layers)
  </constraints>

  <interfaces>
    <interface name="IDbContextFactory&lt;T&gt;" kind="Database abstraction" signature="T CreateDbContext() where T : DbContext" path="Medley.Application/Interfaces/IDbContextFactory.cs" />
    <interface name="IRepository&lt;T&gt;" kind="Data access abstraction" signature="Task&lt;T&gt; GetAsync(int id); IQueryable&lt;T&gt; Query(); Task SaveAsync(T entity)" path="Medley.Application/Interfaces/IRepository.cs" />
    <interface name="IUnitOfWork" kind="Transaction management" signature="Task&lt;int&gt; SaveChangesAsync(); void Dispose()" path="Medley.Application/Interfaces/IUnitOfWork.cs" />
  </interfaces>

  <tests>
    <standards>xUnit testing framework with Moq for mocking. Unit tests for Domain entities and business logic, Application services with mocked dependencies, Repository pattern validation. Integration tests for database operations with real PostgreSQL, authentication and authorization flows. Focus on interface contract compliance and proper dependency injection.</standards>
    <locations>tests/Medley.Domain.Tests/, tests/Medley.Application.Tests/, tests/Medley.Infrastructure.Tests/, tests/Medley.Web.Tests/</locations>
    <ideas>
      AC1: Test project structure creation and proper namespacing
      AC2: Test PostgreSQL connection string configuration and database connectivity
      AC3: Test Entity Framework Core setup and initial migration execution
      AC4: Test health check endpoint accessibility and database health check
      AC5: Test Serilog configuration and log output functionality
      AC6: Integration test for complete development environment setup
      AC7: Test hot reload and debugging capabilities in development environment
    </ideas>
  </tests>
</story-context>