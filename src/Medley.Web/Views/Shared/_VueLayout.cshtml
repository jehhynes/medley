@using Medley.Application.Interfaces
@inject IMedleyContext MedleyContext
@{
    Layout = "_BaseLayout";
    
    // Get current user via MedleyContext (cached for this request)
    var currentUser = await MedleyContext.GetCurrentUserAsync();
    var displayName = currentUser?.FullName ?? currentUser?.Email ?? "User";
    var openSidebarOnMobile = ViewData["OpenSidebarOnMobile"] as bool? ?? false;
}

<!-- Vue will control everything inside this div -->
<div id="app"></div>

@section Scripts 
{
    @* Set user info for Vue pages *@
    <script>
        window.MedleyUser = {
            displayName: '@displayName',
            isAuthenticated: @(User.Identity?.IsAuthenticated == true ? "true" : "false"),
            openSidebarOnMobile: @(openSidebarOnMobile ? "true" : "false")
        };
    </script>
    
    @await RenderSectionAsync("Scripts", required: false)
}
