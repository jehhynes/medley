@{
    ViewData["Title"] = "Settings";
    var organizationId = ViewBag.OrganizationId as Guid? ?? Guid.Empty;
    var emailDomain = ViewBag.EmailDomain as string ?? "";
    var enableSmartTagging = ViewBag.EnableSmartTagging as bool? ?? false;
    var enableSpeakerExtraction = ViewBag.EnableSpeakerExtraction as bool? ?? false;
    var timeZone = ViewBag.TimeZone as string ?? "America/New_York";
}

<div class="main-content-header">
    <h1 class="main-content-title">General Settings</h1>
    <p class="text-muted"> Configure organization-wide settings for smart tagging and email domain detection.</p>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="card mb-4">
    <div class="card-header">
        <h5 class="card-title mb-0">Organization Settings</h5>
    </div>
    <div class="card-body">
        <p class="text-muted mb-3">
           
        </p>
        
        <form asp-action="SaveOrganizationSettings" method="post" class="form-layout">
            <input type="hidden" name="organizationId" value="@organizationId" />
            
            <div class="mb-3 form-group-overlap">
                <label for="emailDomain" class="form-label">Email Domain</label>
                <input type="text" 
                       class="form-control" 
                       id="emailDomain" 
                       name="emailDomain" 
                       value="@emailDomain"
                       placeholder="company.com"
                       maxlength="100" />
                
            </div>
            <div class="form-text">
                The email domain used to identify internal attendees (e.g., "company.com").
                Sources where all attendees are from this domain will be automatically tagged as internal.
            </div>

            <div class="mb-3 mt-4 form-group-overlap">
                <label for="timeZone" class="form-label">Time Zone</label>
                <select class="form-select" 
                        id="timeZone" 
                        name="timeZone">
                    <option value="America/New_York" selected="@(timeZone == "America/New_York")">EST - Eastern Time</option>
                    <option value="America/Chicago" selected="@(timeZone == "America/Chicago")">CST - Central Time</option>
                    <option value="America/Denver" selected="@(timeZone == "America/Denver")">MST - Mountain Time</option>
                    <option value="America/Los_Angeles" selected="@(timeZone == "America/Los_Angeles")">PST - Pacific Time</option>
                    <option value="America/Anchorage" selected="@(timeZone == "America/Anchorage")">AKST - Alaska Time</option>
                    <option value="Pacific/Honolulu" selected="@(timeZone == "Pacific/Honolulu")">HST - Hawaii Time</option>
                </select>
            </div>
            <div class="form-text mb-3">
                The time zone used for displaying dates and grouping analytics data. This affects token usage reports and other time-based analytics.
            </div>

            <div class="my-3">
                <div class="form-check form-switch">
                    <input class="form-check-input" 
                           type="checkbox" 
                           id="enableSmartTagging" 
                           name="enableSmartTagging" 
                           value="true"
                           @(enableSmartTagging ? "checked" : "") />
                    <label class="form-check-label" for="enableSmartTagging">
                        Enable Smart Tagging
                    </label>
                </div>
                <div class="form-text">
                    When enabled, the system will automatically add tags and mark sources as internal/external based on attendee email domains 
                    and meeting name patterns. 
                </div>
            </div>

            <div class="my-3">
                <div class="form-check form-switch">
                    <input class="form-check-input" 
                           type="checkbox" 
                           id="enableSpeakerExtraction" 
                           name="enableSpeakerExtraction" 
                           value="true"
                           @(enableSpeakerExtraction ? "checked" : "") />
                    <label class="form-check-label" for="enableSpeakerExtraction">
                        Enable Speaker Extraction
                    </label>
                </div>
                <div class="form-text">
                    When enabled, the system will automatically extract speaker information from meeting transcripts and identify 
                    internal vs external speakers based on the email domain.
                </div>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-save"></i> Save Settings
                </button>
            </div>
        </form>
    </div>
</div>
